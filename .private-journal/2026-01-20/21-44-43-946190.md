---
title: "9:44:43 PM - January 20, 2026"
date: 2026-01-20T20:44:43.946Z
timestamp: 1768941883946
---

## Project Notes

Fixed ResizableTextEdit resize bug - comprehensive debugging report:

**The Bug:**
When dragging the resize handle on a text editor, only the text_edit widget resized. The gray border container and resize handle stayed in their original positions, not tracking with the resize operation.

**Root Causes (Multiple Issues):**
1. QGraphicsProxyWidget's boundingRect() was not updating when container resized
2. Container was using setFixedSize() which locks the size policy to Fixed
3. The proxy widget wasn't being notified to recalculate its geometry

**What Didn't Work:**

Attempt 1: Remove explicit proxy resize call
- Removed `self.resize()` call, assuming proxy auto-updates with container
- Result: Nothing resized at all
- Why it failed: Proxy doesn't automatically update boundingRect when contained widget changes

Attempt 2: Use setGeometry() on proxy
- Called `self.setGeometry(QRectF(0, 0, new_width, new_height))`
- Result: Still broken, same symptoms
- Why it failed: setGeometry() doesn't work properly on QGraphicsProxyWidget

Attempt 3: Use updateGeometry() alone
- Called only `self.updateGeometry()` after container resize
- Result: No change
- Why it failed: updateGeometry() queries boundingRect(), but we weren't overriding it

**The Solution (3 changes required):**

1. Override boundingRect() to return actual container size:
```python
def boundingRect(self):
    return QRectF(0, 0, self.container.width(), self.container.height())
```
This ensures the proxy's reported bounds match the actual container size.

2. Set container size policy to Preferred (not Fixed):
```python
self.container.setSizePolicy(QSizePolicy.Policy.Preferred, QSizePolicy.Policy.Preferred)
```
This allows the container to resize freely instead of being locked to a fixed size.

3. Use resize() instead of setFixedSize() everywhere:
- In __init__: `self.container.resize(...)` not `setFixedSize(...)`
- In mouseMoveEvent: `self.container.resize(...)` not `setFixedSize(...)`
- setFixedSize() sets size policy to Fixed, preventing growth

**Key Insights:**

QGraphicsProxyWidget behavior:
- Does NOT automatically update its boundingRect when contained widget resizes
- Must override boundingRect() to return the actual widget size
- Must call prepareGeometryChange() before resize to trigger boundingRect() re-query
- The resize handle calculation uses boundingRect(), so if that's stale, handle doesn't move

Widget size policies matter:
- setFixedSize() locks widget to Fixed size policy - can't grow
- resize() with Preferred policy allows normal resizing
- In a layout, Fixed policy can prevent proper resizing even with explicit calls

Debugging technique that worked:
- Added debug prints showing container size, proxy size, and boundingRect before/after
- This revealed that container WAS resizing but proxy boundingRect was NOT
- Led to understanding that boundingRect() needed to be overridden

**Files modified:** src/nconotes/main.py:31-184

## Technical Insights

QGraphicsProxyWidget resizing pattern:

The correct pattern for making a resizable QGraphicsProxyWidget:

1. Override boundingRect() to return actual widget dimensions:
```python
def boundingRect(self):
    return QRectF(0, 0, self.widget.width(), self.widget.height())
```

2. Use Preferred size policy on contained widget, not Fixed

3. In resize handler:
   - Call prepareGeometryChange() first (notifies scene)
   - Resize contained widget with resize() not setFixedSize()
   - Call updateGeometry() after (optional but good practice)
   - Call update() to trigger repaint

Why this is necessary:
- QGraphicsProxyWidget doesn't automatically sync its boundingRect with widget size
- boundingRect() is cached by QGraphicsScene for performance
- prepareGeometryChange() invalidates cache and triggers boundingRect() re-query
- If you don't override boundingRect(), you get the default behavior which may be stale

Common mistake: Using setFixedSize() 
- Sets QSizePolicy to Fixed, preventing resize
- Even calling setFixedSize() again with new size doesn't always work properly
- Use resize() with Preferred/Expanding size policy instead
